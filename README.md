# Вероятностное прогнозирование полей нефтенасыщенности с использованием диффузионных моделей

Репозиторий содержит код и эксперименты по вероятностному прогнозированию пространственно-временных полей нефтенасыщенности на основе условных диффузионных моделей.

Работа выполнена в рамках магистерской подготовки по направлению «Искусственный интеллект в промышленности» индустриального трека крупной нефтегазовой компании.

---

## Структура репозитория

├── gdm_diffusion.ipynb # основной ноутбук: обучение модели, инференс и эксперименты

├── diffusion_best.pt # сохранённый чекпоинт обученной диффузионной модели

├── gdm_saturation.npz # датасет с полями нефтенасыщенности (основной)

├── spe9_saturation.npz # альтернативный датасет / тестовый пример

├── data.rar # архив с дополнительными данными и вспомогательными файлами

├── README.md # описание проекта и методологии

---

## Мотивация

Классические гидродинамические модели и детерминированные нейросетевые подходы, как правило, формируют **единственный сценарий прогноза**, не отражая неопределённость, связанную с:
- неполнотой геологической информации,
- неопределённостью начальных условий,
- параметрическими и структурными допущениями модели.

В то же время инженерные решения в разработке месторождений требуют **учёта диапазона возможных сценариев**, а не одного детерминированного прогноза.

Цель данной работы — построение модели, способной **генерировать ансамбль согласованных сценариев развития нефтенасыщенности** при фиксированном начальном состоянии.

---

## Постановка задачи

Дано:
- поле нефтенасыщенности в момент времени *t₀*,
- номер геологического слоя,
- относительный горизонт прогноза.

Требуется:
- предсказать **распределение возможных будущих полей нефтенасыщенности**,
- с возможностью генерации нескольких сценариев для оценки неопределённости.

Задача формулируется как **условное вероятностное прогнозирование физических полей**.

---

## Метод

В работе используется условная диффузионная модель, обучаемая на парах:
- базовое состояние (base),
- целевое состояние или приращение (target).

Ключевые особенности подхода:
- прогноз может формулироваться как предсказание **изменения насыщенности** (delta-режим);
- модель условлена на:
  - начальное поле,
  - относительный временной горизонт,
  - номер геологического слоя;
- возможна генерация ансамбля сценариев за счёт стохастичности диффузионного процесса;
- опционально используется латентное пространство (VAE) для ускорения вычислений.

---

## Архитектура

- U-Net-подобная архитектура в качестве шумопредсказателя;
- условные каналы:
  - маска активных ячеек,
  - базовое состояние,
  - код временного горизонта,
  - код геологического слоя;
- диффузионный процесс с возможностью DDPM / DDIM семплинга;
- EMA-усреднение весов для стабилизации обучения.

---

## Обучение

Данные делятся на:
- обучающую выборку (train),
- валидационную выборку (val) по временным срезам.

Контроль качества осуществляется за счёт:
- отслеживания train / validation loss,
- раннего сохранения лучшей модели по валидационной ошибке,
- использования EMA.

Модель обучается без утечки данных будущих временных шагов.

---

## Оценка качества

Для оценки используются как детерминированные, так и вероятностные метрики:

- RMSE / MAE — точность среднего прогноза;
- SSIM — сохранение пространственной структуры;
- IoU — корректность фронта вытеснения;
- CRPS — качество вероятностного прогноза;
- Coverage — адекватность оценки неопределённости.

Численные результаты приведены в ноутбуках экспериментов.

---

## Генерация сценариев

После обучения модель позволяет:
- загрузить одно начальное поле;
- сгенерировать несколько сценариев развития;
- получить статистики (среднее, дисперсия, p10/p50/p90).

Это позволяет рассматривать модель как **прокси-инструмент сценарного анализа**.

---


---

## Ограничения

- эксперименты проведены на модельных данных;
- промышленная апробация не входила в цели работы;
- перенос на реальный объект требует дополнительной адаптации.

---

## Статус проекта

Исследовательский прототип.  
Код предназначен для воспроизводимых экспериментов и дальнейшего развития.
